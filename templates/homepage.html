<!DOCTYPE html>
<html>
<head>
    <title>Home ‚Äî Secure Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#0f1724;--panel:#0b1220;--accent:#5865F2;--muted:#93a2b8}
        body{margin:0;min-height:100vh;background:linear-gradient(135deg,var(--bg),#071028);font-family:Inter,system-ui,Arial;color:#e6eef8}
        .home-card{max-width:960px;margin:40px auto;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:18px;display:flex;gap:20px;box-shadow:0 12px 40px rgba(2,6,23,0.7)}
        .sidebar{width:220px;padding:12px;border-right:1px solid rgba(255,255,255,0.03)}
        .content{flex:1;padding:10px}
        .btn-menu{display:block;padding:12px;margin-bottom:10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:#e6eef8;text-decoration:none;font-weight:600;transition:background .15s ease}
        .btn-menu:hover{background:rgba(88,101,242,0.08)}
        .title{color:var(--accent);font-weight:700;margin-bottom:6px}
        .dm-section{margin-top:20px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.03)}
        .dm-list{display:flex;flex-direction:column;gap:6px}
        .dm-link{padding:10px;border-radius:6px;background:rgba(88,101,242,0.08);color:#e6eef8;text-decoration:none;font-size:14px;transition:background .12s ease}
        .dm-link:hover{background:rgba(88,101,242,0.15)}
    </style>
</head>

<body>
    <div class="home-card">
        <div class="sidebar">
            <div class="title">Secure Chat</div>
            <a class="btn-menu" href="/groupchat"># group-chat</a>
            <a class="btn-menu" href="/search">üîé Search users</a>
            {% if session.role == "owner" %}
                <a class="btn-menu" href="/userlist">üë• User List</a>
            {% endif %}
            <a class="btn-menu" href="/account">‚öôÔ∏è Account</a>
            <a class="btn-menu" href="/logout" style="margin-top:14px;color:#ff8b8b">Logout</a>
        </div>
        <div class="content">
            <h3 style="margin-top:6px">Welcome to Secure Chat</h3>
            <p style="color:var(--muted)">Fast, encrypted messaging with OTP multi-factor and admin moderation.</p>
            <div class="dm-section">
                <div class="title" style="font-size:13px">Direct Messages</div>
                <div id="dmList" class="dm-list"></div>
            </div>
        </div>
    </div>

    <script>
        fetch('/api/dms')
            .then(r => r.json())
            .then(data => {
                const dmList = document.getElementById('dmList');
                if (data.users && data.users.length) {
                    dmList.innerHTML = data.users.map(u => 
                        `<a href="/dmchat?user=${u}" class="dm-link">üí¨ ${u}</a>`
                    ).join('');
                } else {
                    dmList.innerHTML = '<p style="color:var(--muted);font-size:13px">No DMs yet. Start one from Search!</p>';
                }
            })
            .catch(e => console.error('Failed to load DMs:', e));
    </script>
</body>
</html>
